
<% //console.log(`HERE ARE THE DATES I HAVE : ${dates}`) %>
<% let elevatedArray = [] %>
<% let depressedArray = [] %>
<% let irritableArray = [] %>
<% let anxiousArray = [] %>
<% let sleepArray = []%>

<%// const anxietyData = () => { %>
    <%// moods.forEach(m => { %>
        <% //if(m.anxious !== null) { %>
            <%// anxiousArray.push(m.anxious) %>
            <%// } else { %>
                <%// anxiousArray.push(0)} %>
    <% //}) %>
<%// }%>
<% //anxietyData() %>
    <%// console.log(`ANXIETY ARRAY : ${anxiousArray}`) %>



<% const getData = (metric, array) => {%>
    <% moods.forEach(m => { %>
        <% if (m[metric] !== null) {%>
            <% array.push(m[metric]) %>
        <% } else { %>
            <% array.push(0)%>
        <% } %>
    <% }) %>
<% } %>

<% getData('anxious', anxiousArray) %>
<% console.log(anxiousArray) %>

<main>              
<h1>DASHBOARD</h1>

<h4>Your Week at a Glance</h4>
<canvas class="chart-view" id="elevated-chart"></canvas>
<canvas class="chart-view" id="depressed-chart"></canvas>
<canvas class="chart-view" id="irritable-chart"></canvas>
<canvas class="chart-view" id="anxious-chart"></canvas>

</main>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    let clientDates = '<%- JSON.stringify(dates) %>';
    let clientAnxiety = '<%- JSON.stringify(anxiousArray) %>';

    // remove the brackets and quotes from dates string and split into array
    clientDates = clientDates.replace(/[\[\]"]+/g, '');
    clientDates = clientDates.split(',');
    console.log(`CLIENT DATES : ${clientDates}`)
    
    clientAnxiety = clientAnxiety.replace(/[\[\]"]+/g, '');
    clientAnxiety = clientAnxiety.split(',');
    // console.log(clientAnxiety)
    
    // var ctx = document.getElementById('anxious-chart').getContext('2d');
    // var chart = new Chart(ctx, {
    //     // The type of chart we want to create
    //     type: 'line',

    //     // The data for our dataset
    //     data: {
    //         labels: clientDates,
    //         datasets: [{
    //             label: 'Anxiety',
    //             backgroundColor: 'rgb(4, 200, 214)',
    //             borderColor: 'rgb(4, 95, 214)',
    //             data: clientAnxiety
    //         }]
    //     },
    //     options: {}
    // });

    const buildChart = (elemId, data, label, backgroundRbg, borderRbg) => {
        var ctx = document.getElementById(elemId).getContext('2d')
        var chart = new Chart(ctx, {
            type: 'line',

            data: {
                labels: clientDates,
                datasets: [{
                    label: label,
                    backgroundColor: backgroundRbg,
                    borderColor: borderRbg,
                    data: data
                }]
            },
            options: {}
        })
    }
    buildChart('anxious-chart', clientAnxiety, 'Anxiety', 'rgb(4, 200, 214)', 'rgb(4, 95, 214)' )

        // var chart = new Chart(ctx, {
        //     // The type of chart we want to create
        //     type: 'line',
    
        //     // The data for our dataset
        //     data: {
        //         labels: [1, 2],
        //         datasets: [{
        //             label: 'Anxiety',
        //             backgroundColor: 'rgb(255, 99, 132)',
        //             borderColor: 'rgb(255, 99, 132)',
        //             data: [0, 33, 44, 50, 10, 19, 11]
        //         }]
        //     },
    
        //     // Configuration options go here
        //     options: {}
        // });
</script>